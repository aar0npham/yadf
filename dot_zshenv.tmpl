#!/usr/bin/env bash

{{- if eq .chezmoi.os "darwin" }}
export CHEZMOI_BIN="$(which chezmoi)"
export EDITOR='/usr/local/bin/nvim'
export VISUAL='/usr/bin/vim'
export JAVA_HOME="/usr/local/opt/openjdk/libexec/openjdk.jdk/Contents/Home"
export BASH_SILENCE_DEPRECATION_WARNING=1;
{{- end }}
{{- if eq .chezmoi.os "linux" }}
export CHEZMOI_BIN="$(command -v chezmoi)"
export EDITOR='/usr/bin/nvim'
export VISUAL='/usr/bin/nvim'
export DISPLAY=:0
# wine prefix
export WINEPREFIX="$HOME/.wine32"
export WINEARCH=win32
{{- end }}

export BROWSER='/usr/bin/firefox'
export LS_COLORS="${LS_COLORS}:ow=01;33"
export SSH_ENV="$HOME/.ssh/agent-environment"

{{ $fzf := `command -v fzf` }}
{{- if $fzf }}
export FZF_DEFAULT_OPTS="--layout=reverse
--info=inline
--height=80%
--multi
--preview-window=:hidden
--preview '([[ -f {} ]] && (bat --style=numbers {} || cat {})) || ([[ -d {} ]] && (tree -C {} | less)) || echo {} 2> /dev/null | head -200'
--prompt='∼ ' --pointer='>' --marker='✓'
--bind '?:toggle-preview'
--bind 'ctrl-a:select-all'
--bind 'ctrl-y:execute-silent(echo {+} | pbcopy)'
--bind 'ctrl-e:execute(echo {+} | xargs -o vim)'
--bind 'ctrl-v:execute(code {+})'";
export FZF_DEFAULT_COMMAND='rg --files --no-ignore --hidden --follow -g "!{.git,node_modules}/*" 2> /dev/null'
export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"
export FZF_CTRL_T_OPTS='--preview="cat {}" --preview-window=right:60%:wrap'
export FZF_ALT_C_OPTS='--preview="ls {}" --preview-window=right:60%:wrap'
{{- end }}

{{ $pyenv := `command -v pyenv` }}
{{- if $pyenv}}
# export python
export PYENV_ROOT="$HOME/.pyenv"
export PYENV_SHELL=$SHELL
{{- end }}
# Make Python use UTF-8 encoding for output to stdin, stdout, and stderr.
export PYTHONIOENCODING='UTF-8';
export PYTHONDONTWRITEBYTECODE=1

# XDG  config
export XDG_CONFIG_DIRS="/etc/xdg"
export XDG_CONFIG_HOME="$HOME/.config"
export XDG_CONFIG_DOCUMENTS="$HOME/Documents"
export GTK_IM_MODULE=ibus
export XMODIFIERS=@im=ibus
export QT_IM_MODULE=ibus
export QT_QPA_PLATFORMTHEME="qt5ct"

# npm config
export NPM_PACKAGES="${HOME}/.npm-packages"
export NODE_PATH="$NPM_PACKAGES/lib/node_modules:$NODE_PATH"

# defined go path
export GOPATH="$HOME/go"
export GOPROXY="https://proxy.golang.org/,direct"

# define Gem path
export GEMPATH="$HOME/.gem/ruby/2.7.0"

# define PATH
export PATH="{{ .chezmoi.homedir }}/.pyenv/shims:$NPM_PACKAGES/bin:$HOME/google-cloud-sdk/bin:$GEMPATH/bin:$GOPATH/bin:$GOPATH/src:$PYENV_ROOT/bin:$HOME/.local/bin:$HOME/.cargo/bin:${PATH}"
{{- if eq .chezmoi.os "darwin" }}
export PATH="${PATH}:$JAVA_HOME/bin"
{{- end }}

# Increase Bash history size. Allow 32³ entries; the default is 500.
export HISTFILE=~/.histfile
export HISTSIZE='32768';
export HISTFILESIZE="${HISTSIZE}";
# Omit duplicates and commands that begin with a space from history.
export HISTCONTROL='ignoreboth';

# Prefer CA English and use UTF-8.
export LANGUAGE='en';
export HOST='{{ .chezmoi.fullHostname }}';
export LC_ALL="en_US.UTF-8"
export LANG="en_US.UTF-8"

# Highlight section titles in manual pages.
export LESS_TERMCAP_md="${yellow}";

# Don’t clear the screen after quitting a manual page.
export MANPAGER='less -X';

{{ $fzf := `command -v nnn` }}
{{- if $fzf }}
#nnn
export NNN_BMS='u:~/Documents;D:~/Downloads/'
export NNN_SSHFS="sshfs -o follow_symlinks"
export NNN_COLORS="2134"
export NNN_TRASH=1
export NNN_PLUG='f:finder;o:fzopen;p:mocplay;d:diffs;t:nmount;v:imgview'
export NNN_FIFO=/tmp/nnn.fifo
{{- end }}


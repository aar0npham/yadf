{{/* boolean feature tags */}}
{{- $personal := false -}}{{/* true if this machine should have personal secrets from BitWarden */}}
{{- $headless := false -}}{{/* true if this machine does not have a screen and keyboard */}}
{{- $transient := false -}}{{/* true if this machine is temporary, e.g. a cloud or VM instance */}}
{{- $kubernetes := false -}}{{/* true if this machine is used for Kubernetes work */}}
{{- $city := "Hanoi" -}}{{/* city inputs for weather */}}
{{- $wm := env "XDG_SESSION_DESKTOP" -}}{{/* current windows manager in use (default to awesome) */}}

{{/* work around unreliable hostname on darwin */}}
{{- $hostname := .chezmoi.hostname -}}
{{- if eq .chezmoi.os "darwin" -}}
{{-   $serialNumberSHA256Sum := index ioreg "IORegistryEntryChildren" 0 "IOPlatformSerialNumber" | sha256sum -}}
{{-   if eq $serialNumberSHA256Sum "21bc2b3dba08a4f53732b42ac8b041ac2a83ebe95b73dfc2b5c251b4767463d8" -}}
{{-     $hostname = "APPL-AIR12" -}}
{{-   end -}}
{{- end -}}
{{- if not $transient -}}
{{-   if eq $hostname "APPL-AIR12" -}}
{{-     $personal = true -}}
{{-     $wm := "none" -}}
{{-     $city = promptString "Current city"}}
{{-   else if eq $hostname "0x6161726E70" -}}
{{-     $personal = true -}}
{{-     $city = promptString "Current city" -}}
{{-   else -}}
{{-     $headless = promptBool "headless" -}}
{{-     $transient = promptBool "transient" -}}
{{-     $kubernetes = promptBool "kubernetes" -}}
{{-   end -}}
{{- end -}}

[data]
  wm = {{ $wm | quote }}
  city = {{ $city | quote }}
  hostname = {{ $hostname | quote }}
  personal = {{ $personal }}
  headless = {{ $headless }}
  transient = {{ $transient }}
  kubernetes = {{ $kubernetes }}
